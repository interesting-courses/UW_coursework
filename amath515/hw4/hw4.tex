\documentclass[10pt]{article}
\usepackage[T1]{fontenc}

% Document Details
\newcommand{\CLASS}{AMATH 515}
\newcommand{\assigmentnum}{Problem Set 4}

\usepackage[margin = 1.5in]{geometry}
\input{../../import/title.tex} % Title Styling
\input{../../import/styling.tex} % General Styling
\input{../../import/code.tex} % Code Display Setup
\input{../../import/math.tex} % Math shortcuts
\input{../../import/proof.tex} % Proof shortcuts
\input{../../import/problem.tex} % Problem Environment

\rhead{\sffamily Tyler Chen \textbf{\thepage}}

\let\savedprob=\problem%
\def\problem[#1]{\pagebreak\phantomsection\addcontentsline{toc}{subsection}{#1}\savedprob[#1]\label{#1}\setcounter{page}{1}}

\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\range}{\operatorname{range}}
\newcommand{\prox}{\operatorname{prox}}
\DeclareMathOperator*{\proj}{\operatorname{proj}}

\usepackage{placeins}

\begin{document}
\maketitle

\begin{problem}[Problem 1]
Prove the following identity for \( \alpha \in \mathbb{R} \):
\begin{align*}
    \|\alpha x + (1-\alpha) y\|^2 + \alpha(1-\alpha) \|x-y\|^2 = \alpha \|x\|^2 + (1-\alpha) \|y\|^2.
\end{align*}
\end{problem}

\begin{solution}[Solution]
Recall that, \( \| z \|^2 = \ip{z,z} \). Then,
\begin{align*}
    \| \alpha x + (1-\alpha) y \|^2 &= \ip{\alpha x + (1-\alpha) y,\alpha x + (1-\alpha) y}
    \\&= \alpha^2 \ip{x,x} + 2 \alpha(1-\alpha)\ip{x,y} + (1-\alpha)^2 \ip{y,y}
\end{align*}

Similarly,
\begin{align*}
    \| x - y \|^2 &= \ip{x-y,x-y}
    = \ip{x} - 2\ip{x,y} + \ip{y^2}
\end{align*}

Then clearly,
\begin{align*}
    \|\alpha x + (1-\alpha) y\|^2 + \alpha(1-\alpha) \|x-y\|^2 = \alpha \|x\|^2 + (1-\alpha) \|y\|^2 \tag*{\qed}
\end{align*}


\end{solution}

\begin{problem}[Problem 2]
An operator \( T \) is {\it nonexpansive} if  \( \|Tx - Ty\| \leq \|x - y\| \) for all \( (x,y) \). 
For any such nonexpansive operator \( T \), define 
\begin{align*}
    T_\lambda = (1-\lambda)I + \lambda T. 
\end{align*}
\begin{enumerate}[nolistsep,label=(\alph*)]
\item Show that \( T_\lambda \) and \( T \) have the same fixed points. 
\item Use problem 1 to show 
\begin{align*}
    \|T_\lambda z - \overline z\|^2 \leq \|z-\overline z\|^2 - \lambda(1-\lambda) \|z - Tz\|^2.
\end{align*}
where \( \overline z \) is any fixed point of \( T \), i.e. \( T\overline z = \overline z \).
\end{enumerate}
\end{problem}

\begin{solution}[Solution]
    Recall that \( x \) is a fixed point of \( f \) if \( f(x) = x \).
\begin{enumerate}[label=(\alph*)]
    \item 
        If \( \lambda = 0 \) then all points are fixed points of \( T_{\lambda} \) but not all points may be fixed points of \( T \).
        Assuming \( \lambda \neq 0 \) then,
        \begin{align*}
            & x = T_{\lambda} x
            \\\Longleftrightarrow~ & x = ((1-\lambda)I + \lambda T)x
            \\\Longleftrightarrow~ & x = (1-\lambda)x + \lambda Tx
            \\\Longleftrightarrow~ & \lambda x = \lambda Tx
            \\\Longleftrightarrow~ & x = Tx \tag*{\qed}
        \end{align*}
    \item Suppose \( \overline{z} \) is a fixed point of \( T \) so that \( \overline{z} = (1-\lambda) \overline{z} + \lambda T \overline{z} \). Then,
        \begin{align*}
            \| T_{\lambda} z - \overline{z} \|^2
            = \| (1-\lambda)(z-\overline{z}) + \lambda T(z-\overline{z}) \|^2
        \end{align*}

        By problem 1, and since \( T \) is nonexpansive so that \( \|T(z-\overline{z})\| \leq \|z-\overline{z}\| \),
        \begin{align*}
            \| T_{\lambda}z - \overline{z} \|^2 &= \lambda \| z-\overline{z} \|^2 + (1-\lambda) \| T(z-\overline{z}) \|^2 - \lambda(1-\lambda)\|(z-\overline{z}) - T(z-\overline{z})\|^2
            \\& \leq \lambda \| z-\overline{z} \|^2 + (1-\lambda) \| z-\overline{z} \|^2 - \lambda(1-\lambda)\|(z-\overline{z}) - T(z-\overline{z})\|^2
            \\& = \| z-\overline{z} \|^2 - \lambda(1-\lambda)\|(z-\overline{z}) - T(z-\overline{z})\|^2 \tag*{\qed}
        \end{align*}

\end{enumerate}
\end{solution}

\begin{problem}[Problem 3]
An operator \( T \) is {\it firmly nonexpansive} when it satisfies 
\begin{align*}
    \|Tx - Ty\|^2 + \|(I-T) x - (I-T)y\|^2 \leq \|x-y\|^2. 
\end{align*}


\begin{enumerate}[nolistsep,label=(\alph*)]
\item Show \( T \) is firmly nonexpansive if and only if 
\begin{align*}
    \langle x-y, Tx - Ty \rangle \geq \|Tx - Ty\|^2. 
\end{align*}

\item Show \( T \) is firmly nonexpansive if and only if 
\begin{align*}
    \langle Tx - Ty, (I-T)x - (I-T)y \rangle \geq 0. 
\end{align*}

\item Suppose that \( S = 2T - I \). Let 
\begin{align*}
    \mu = \|Tx - Ty\|^2 + \|(I-T)x - (I-T)y\|^2 - \|x-y\|^2
\end{align*}
and let 
\begin{align*}
    \nu = \|Sx - Sy\|^2 - \|x-y\|^2.
\end{align*}
Show that \( 2\mu = \nu \) (you may find it helpful to use problem (1)). Conclude that 
\( T \) is firmly nonexpansive exactly when \( S \) is nonexpansive. 

\end{enumerate}
\end{problem}

\begin{solution}[Solution]
\begin{enumerate}[label=(\alph*)]
    \item Observe that,
        \begin{align*}
            \| (I-T)x - (I-T)y \|^2 &= \| (x-y)-(Tx-Ty) \|^2
            \\&= \|x-y\|^2 + \|Tx - Ty\|^2 - 2 \ip{x-y,Tx-Ty}
        \end{align*}
        Thus,
        \begin{align*}
            & \|Tx - Ty\|^2 + \|(I-T) x - (I-T)y\|^2 \leq \|x-y\|^2
            \\ \Longleftrightarrow ~& 
            \| Tx - Ty \|^2 + \|x-y\|^2 + \|Tx - Ty\|^2 - 2 \ip{x-y,Tx-Ty} \leq \|x-y \|^2
            \\ \Longleftrightarrow ~& 
            \|Tx - Ty\|^2  \leq  \ip{x-y,Tx-Ty} \tag*{\qed}
        \end{align*}
        
    \item Observe that,
        \begin{align*}
            \| Tx-Ty \|^2 = \ip{Tx-Ty,Tx-Ty}
        \end{align*}
        Thus,
        \begin{align*}
            &\ip{x-y,Tx-Ty} \geq \|Tx-Ty\|^2
            \\ \Longleftrightarrow ~&
            \ip{x-y,Tx-Ty} - \ip{Tx-Ty,Tx-Ty} \geq 0
            \\ \Longleftrightarrow ~&
            \ip{(x-y) - (Tx-Ty),Tx-Ty} \geq 0
            \\ \Longleftrightarrow ~&
            \ip{Tx-Ty,(I-T)x - (I-T)y} \geq 0 \tag*{\qed}
        \end{align*}
        
    \item Define,
        \begin{align*}
            u = (I-T)x - (I-T)y, && v = Tx - Ty
        \end{align*}

        Then, by problem 1 with \( \alpha = 1/2 \) we have,
        \begin{align*}
            \| u/2+v/2 \|^2 + \frac{1}{4}\|u-v\|^2 = \frac{1}{2} \| u \|^2 + \frac{1}{2}\| v \|^2 
        \end{align*}
        Equivalently,
        \begin{align*}
            \| u+v \|^2 + \| u-v \|^2 = 2 \| u \|^2 + 2 \| v \|^2
        \end{align*}

        Substituting our expressions for \( u \) and \( v \) we have,
        \begin{align*}
            \| x - y \|^2 + \| (I-2T)x - (I-2T)y \|^2 = 2\|(I-T)x - (I-T)y\|^2 + 2\|Tx-Ty\|^2
        \end{align*}

        Rearranging, and using the definition \( S = 2T-I \) we have,
        \begin{align*}
            \|Sx-Sy\|^2 - \|x-y\|^2 = 2\|(I-T)x - (I-T)T\|^2 + 2\|Tx-Ty\|^2 - 2\|x-y\|^2
        \end{align*}

        This is exactly the statement,
        \begin{align*}
            2\mu = \nu \tag*{\qed}
        \end{align*}
        
\end{enumerate}
\end{solution}

\begin{problem}[Problem 4]
Implement an interior point method to solve the problem 
\begin{align*}
    \min_x \frac{1}{2}\|Ax-b\|^2 \quad \mbox{s.t.} \quad Cx \leq d. 
\end{align*}
Let the user input \( A \), \( b \), \( C \), and \( d \). Test your algorithm using a box constrained problem 
(where you can apply the prox-gradient method). 
\end{problem}

\begin{solution}[Solution]
We would like to solve \( F=0 \) where,
\begin{align*}
    F = \left[\begin{array}{c}A^T(Ax-b)+C^Tv \\ V(d-Cx) - \mu \cdot 1\end{array}\right]
\end{align*}

We compute Jacobian,
\begin{align*}
    J_F = \left[\begin{array}{cc}A^TA & C^T \\ -VC & \operatorname{diag}(d-Cx) \end{array}\right]
\end{align*}


\end{solution}

\begin{problem}[Problem 5]
Implement a Chambolle-Pock method to solve  
\[
\min_{x} \|Ax-b\|_1 + \|x\|_1. 
\]
\end{problem}

\begin{solution}[Solution]
Suppose we would like to solve,
\begin{align*}
    \min_x \hat{h}(Ax) + \hat{k}(x)
\end{align*}

The Chambolle-Pock algorithm has iterates,
\begin{align*}
    x^+ &= \operatorname{prox}_{\alpha \hat{k}}(x+\alpha A^Tv) \\
    v^+ &= \operatorname{prox}_{\alpha \hat{h}^*}(-v-\alpha A(x-2x^+))
\end{align*}

Now suppose that our functions \( \hat{k} \) and \( \hat{h} \) have the form,
\begin{align*}
    \hat{h}(x) = h(b-x)
    ,&& 
    \hat{k}(x) = \ip{c,x} + k(x)
\end{align*}

Now observe that,
\begin{align*}
    \hat{h}^*(x) &= \sup_z \ip{x,z} - h(b-z)
    \\&= \sup_w \ip{x,b-w} - h(w)
    \\&= \sup_w \ip{-x,w} - h(w) + \ip{x,b}
    \\&= h^*(-x) + \ip{x,b}
\end{align*}

Therefore,
\begin{align*}
    \operatorname{prox}_{\alpha \hat{h}^*}(y) &= \arg\min_{x} \frac{1}{2 \alpha} \| x-y \|^2 + \hat{h}^*(x)
    \\&= \arg\min_{x} \frac{1}{2 \alpha} \| x-y \|^2 + h^*(-x) + \ip{x,b}
    \\&= \arg\min_{x} \frac{1}{2 \alpha} \| x + (y-\alpha b) \|^2 + h^*(-x)
    \\&= \operatorname{prox}_{\alpha h^*}(-(y-\alpha b))
    \\&= \operatorname{prox}_{\alpha h^*}(\alpha b-y)
\end{align*}

By completing the square,
\begin{align*}
    \operatorname{prox}_{\alpha \hat{k}}(y) &= \arg\min_x \frac{1}{2 \alpha}\| x-y \|^2 + \hat{k}(x) 
    \\&= \arg\min_x \frac{1}{2 \alpha} \| x-y \|^2 + k(x) + \ip{c,x}
    \\&= \arg\min_x \frac{1}{2 \alpha} \| x-(y-\alpha c) \|^2 + k(x)
    \\&= \operatorname{prox}_{\alpha k}(y-\alpha c)
\end{align*}

Therefore, in terms of \( h \) and \( k \) we have iterates,
\begin{align*}
    x^+ &= \operatorname{prox}_{\alpha k}(x+\alpha A^Tv-\alpha c) 
    = \operatorname{prox}_{\alpha k}(x+\alpha(A^Tv-c))
    \\ v^+ &= \operatorname{prox}_{\alpha h^*}(\alpha b+v+\alpha A(x-2 x^+))
    = \operatorname{prox}_{\alpha h^*}(v + \alpha(Ax-b + 2b-Ax^+))
\end{align*}

We now turn to the original problem which we write this as,
\begin{align*}
    \min_x \ip{c,x} + h(b-Ax) + k(x) 
\end{align*}
where,
\begin{align*}
    h(x) = \| x \|_1
    ,&&
    k(x) = \| x \|_1
    ,&&
    c=0
\end{align*}

Therefore,
\begin{align*}
    h^*(z) = \delta_{\mathbb{B}_\infty}(x)
    ,&&
    \operatorname{prox}_{\alpha h^*}(z) = \max(\min(z,1),-1)
\end{align*}
and
\begin{align*}
    \operatorname{prox}_{\alpha k}(z) = 
     \begin{cases}
        z_i+t, & z_i \in (-\infty,t) \\
        0, & z_i \in [-t,t] \\
        z_i-t, & z_i \in (t,\infty)
    \end{cases}
\end{align*}

\end{solution}
\end{document}
