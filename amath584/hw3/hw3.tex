\documentclass[10pt]{article}
\usepackage[T1]{fontenc}

% Document Details
\newcommand{\CLASS}{AMATH 584}
\newcommand{\assigmentnum}{Assignment 3}

\usepackage[margin = 1.15in, top = 1.25in, bottom = 1.in]{geometry}

\input{../../TeX_headers/title.tex} % Title Styling
\input{../../TeX_headers/sfftoc.tex} % General Styling
\input{../../TeX_headers/styling.tex} % General Styling
\input{../../TeX_headers/code.tex} % Code Display Setup
\input{../../TeX_headers/math.tex} % Math shortcuts
\input{../../TeX_headers/problem.tex} % Problem Environment

\newcommand{\note}[1]{\textcolor{red}{\textbf{Note:} #1}}

\hypersetup{
   colorlinks=true,       % false: boxed links; true: colored links
   linkcolor=violet,          % color of internal links (change box color with linkbordercolor)
   citecolor=green,        % color of links to bibliography
   filecolor=magenta,      % color of file links
   urlcolor=cyan           % color of external links
}


\begin{document}
\maketitle

\begin{problem}[Exercise 6.1]
If \( P \) is an orthogonal projector, then \( I-2P \) is unitary. Prove this algebraiclly, and give a geometric interpretation.
\end{problem}

\begin{solution}[Solution]

Suppose \( P \) is an orthogonal projector. Then \( P^2=P = P^* \). Thus,
\begin{align*}
	(I-2P)(I-2P)^* = (I-2P)(I^*-2P^*) = (I-2P)(I-2P) = I^2-2P-2P+4P^2 = I-4P+4P = I
\end{align*}

This proves \( I-2P \) is unitary.

\begin{figure}[H]\centering
    \begin{tikzpicture}
        \draw[] (0,-3) -- (0,3);
        \draw[] (-5,0) -- (5,0);
        \draw[dashed] (-5,-2) -- (5,2);
        \draw[dashed] (6/5,-3) -- (-6/5,3);
        \node[right] at (-4,-2){\(\operatorname{range}(P)\)};
        \node[right] at (1,-2){\(\operatorname{ker}(P)\)};
        \draw[fill] (1,2) node[above] {\(v\)} circle[radius=.08];
        \draw[fill] (45/29,18/29) node [below] {\(Pv\)} circle[radius=.08]; 
        \draw[fill] (-61/29, 22/29) node[above] {\(v-2Pv\)} circle[radius=.08];
    \end{tikzpicture}
    \caption{Image of \( I-2P \) acts on \( v \)}
    \label{proj}
\end{figure}

Using Figure~\ref{proj} it is clear that \( I-2P \) reflects points about orthogonal compliment of \( \operatorname{range}(P) \). Reflecting across \( (\operatorname{range}(P))^\perp = \operatorname{ker}(P) \) twice will do nothing. Since \( (I-2P)^2=(I-2P)(I-2P)^* = I \), this coincides with the algebraic proof above.
\end{solution}

\begin{problem}[Exercise 6.4]
Consider the matrices
\begin{align*}
    A=\left[\begin{array}{cc}1 & 0\\0 & 1\\1 & 0\end{array}\right] && B=\left[\begin{array}{cc}1 & 2\\0 & 1\\1 & 0\end{array}\right]
\end{align*}
Answer the following questions by hand calculation.
\begin{enumerate}
    \item[(a)] What is the orthogonal projector \( P \) onto \( \operatorname{range}(A) \), and what is the image under \( P \) of the vector \( (1,2,3)^* \)?
    \item[(b)] Same question for \( B \)
\end{enumerate}
\end{problem}

\begin{solution}[Solution]
    \begin{enumerate}
    \item[(a)] 
        First observe,
        \begin{align*}
            (A^*A)^{-1} = \left[\begin{array}{cc}2 & 0\\0 & 1\end{array}\right]^{-1} = \dfrac{1}{2}\left[\begin{array}{cc}1 & 0 \\ 0 & 2\end{array}\right] = \left[\begin{array}{cc}\frac{1}{2} & 0\\0 & 1\end{array}\right]
        \end{align*}
        Thus,
        \begin{align*}
            P_A = A(A^*A)^{-1}A^* = \left[\begin{array}{ccc}\frac{1}{2} & 0 & \frac{1}{2} \\ 0 & 1 & 0 \\ \frac{1}{2} & 0 & \frac{1}{2} \end{array}\right] 
        \end{align*}
        So,
        \begin{align*}
            P_A(1,2,3)^* = (2,2,2)^*
        \end{align*}
    \item[(b)]
        First observe,
        \begin{align*}
            (B^*B)^{-1} =  \left[\begin{array}{ccc} 2 & 2 \\ 2 & 5\end{array}\right]^{-1} = \dfrac{1}{6}\left[\begin{array}{cc}5 & -2\\-2 & 2\end{array}\right] = \left[\begin{array}{cc}\frac{5}{6} & -\frac{1}{3} \\ -\frac{1}{3} & \frac{1}{3}\end{array}\right]
       \end{align*}
        Thus,
        \begin{align*}
            P_B = B(B^*B)^{-1}B^* = \left[\begin{array}{ccc} \frac{5}{6} & \frac{1}{3} & \frac{1}{6} \\ \frac{1}{3} & \frac{1}{3} & -\frac{1}{3} \\ \frac{1}{6} & -\frac{1}{3} & \frac{5}{6} \\\end{array} \right]
        \end{align*}
        So,
        \begin{align*}
            P_B(1,2,3)^* = (2,0,2)^*
        \end{align*}
    \end{enumerate}
\end{solution}


\begin{problem}[Exercise 7.1]
Consider again the matrices \( A \) and \( B \) of Exercise 6.4.
\begin{enumerate}
    \item[(a)] Using any method you like, determine (on paper) a reduced QR factorization \( A=\hat{Q}\hat{R} \) and a full QR factorization \( A=QR \).
    \item[(b)] Again using any method you like, determine reduced and full QR factorizations \( B=\hat{Q}\hat{R} \) and \( B=QR \).
\end{enumerate}
\end{problem}

\begin{solution}[Solution]
    The book gives the following algorithm for calculating a reduced QR decomposition.
\begin{lstlisting}[mathescape=true, numbers=left, xleftmargin=2em,frame=single,framexleftmargin=1.5em]
for $j=1$ to $n$
    $v_j=a_j$
    for $i=1$ to $j-1$
        $r_{ij}=q_i^*a_j$
        $v_j=v_j-r_{ij}q_i$
    $r_{jj}=\norm{v_j}_2$
    $q_j=v_j/r_{jj}$
\end{lstlisting}
\begin{enumerate}
    \item[(a)] We have \( a_1 = (1,0,1)^*, a_2=(0,1,0)^* \).
    We use the algorithm listed above:    
        \begin{enumerate}  
        \item[(1)] with \( j=1 \):
            \begin{enumerate}
                \item[(2)]  \( v_1=a_1 \)
                \item[(6)]  \( r_{11} = \norm{v_1}_2 = \sqrt{2} \).
                \item[(7)]  \( q_1 = v_1/r_{11} = (1/\sqrt{2},0,1/\sqrt{2})^* \)
            \end{enumerate}
        \item[(1)] with \( j=2 \)
            \begin{enumerate}
                \item[(2)] \( v_2=a_2 \)
                \item[(3)] with \( i=1 \)
                    \begin{enumerate}
                        \item[(4)] \( r_{21}=q_1^*a_2 = (1/\sqrt{2},0,1/\sqrt{2})(0,1,0) = 0  \)
                        \item[(5)] \( v_2=v_2-0q_1 = (0,1,0) \)
                    \end{enumerate}
                \item[(6)] \( r_{22}=\norm{v_2}_2 = 1 \)
                \item[(7)] \( q_2 = v_2/r_{22} = (0,1,0) \)
            \end{enumerate}
        \end{enumerate}

        This gives reduced QR factorization,
        \begin{align*}
            A = \left[\begin{array}{cc}1 & 0\\0 & 1\\1 & 0\end{array}\right] = \left[\begin{array}{cc}\frac{1}{\sqrt{2}} & 0\\ 0 & 1 \\ \frac{1}{\sqrt{2}} & 0\end{array}\right]\left[\begin{array}{cc}\sqrt{2} & 0 \\ 0 & 1\end{array}\right]
        \end{align*}
        
        We extend this to a full QR factorization by finding a vector orthogonal to \( q_1,q_2 \). First,
        \begin{align*}
            0 &= (1/\sqrt{2},0,1/\sqrt{2})(a,b,c)^* = (a+c)/\sqrt{2} \\
            0 &= (0,1,0)(a,b,c)^* = b \\
            1 &=\sqrt{a^2+b^2+c^2}
        \end{align*}

        Thus \( q_3=(a,b,c) = (1/\sqrt{2},0,-1/\sqrt{2}) \) so
        \begin{align*}
            A = \left[\begin{array}{cc}1 & 0\\0 & 1\\1 & 0\end{array}\right] = \left[\begin{array}{ccc}\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}} \\ 0 & 1 & 0 \\ \frac{1}{\sqrt{2}} & 0 & \frac{-1}{\sqrt{2}} \end{array}\right]\left[\begin{array}{cc}\sqrt{2} & 0 \\ 0 & 1 \\ 0 & 0\end{array}\right]
        \end{align*}

    \item[(b)] We have \( b_1=(1,0,1)^*, b_2=(2,1,0)^* \)
    We use the algorithm listed above:    
        \begin{enumerate}  
        \item[(1)] with \( j=1 \):
            \begin{enumerate}
                \item[(2)]  \( v_1=b_1 \)
                \item[(6)]  \( r_{11} = \norm{v_1}_2 = \sqrt{2} \).
                \item[(7)]  \( q_1 = v_1/r_{11} = (1/\sqrt{2},0,1/\sqrt{2})^* \)
            \end{enumerate}
        \item[(1)] with \( i=2 \)
            \begin{enumerate}
                \item[(2)] \( v_2=b_2 \)
                \item[(3)] with \( i=1 \)
                    \begin{enumerate}
                        \item[(4)] \( r_{12}=q_1^*a_2 = (1/\sqrt{2},0,1/\sqrt{2})(2,1,0) = 2/\sqrt{2}  \)
                        \item[(5)] \( v_2=v_2-r_{12}q_1 = (1,1,-1) \)
                    \end{enumerate}
                \item[(6)] \( r_{22}=\norm{v_2}_2 = \sqrt{3} \)
                \item[(7)] \( q_2 = v_2/r_{22} = (1/\sqrt{3},1/\sqrt{3},-1/\sqrt{3}) \)
            \end{enumerate}
        \end{enumerate}

        This gives reduced QR factorization,
        \begin{align*}
            B = \left[\begin{array}{cc}1 & 2\\0 & 1\\1 & 0\end{array}\right] = \left[\begin{array}{cc}\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}}\\ 0 & \frac{1}{\sqrt{3}} \\ \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{3}}\end{array}\right]\left[\begin{array}{cc}\sqrt{2} & \frac{2}{\sqrt{2}} \\ 0 & \sqrt{3}\end{array}\right]
        \end{align*}
  
        We extend this to a full QR factorization by finding a vector orthogonal to \( q_1,q_2 \). First,
        \begin{align*}
            0 &= \left(\frac{1}{\sqrt{2}},0,\frac{1}{\sqrt{2}}\right)(a,b,c)^* = \frac{a+c}{\sqrt{2}} \\
            0 &=\left(\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}},\frac{-1}{\sqrt{3}}\right)\left[\begin{array}{c}a\\b\\c\end{array}\right](a,b,c)^* = \frac{a+b-c}{\sqrt{3}} \\
            1 &=\sqrt{a^2+b^2+c^2}
        \end{align*}

        Thus \( q_3=(a,b,c) = (-1/\sqrt{6},2/\sqrt{6},1/\sqrt{6}) \) so,
        
        We extend this to a full QR factorization,
         \begin{align*}
             B = \left[\begin{array}{cc}1 & 2\\0 & 1\\1 & 0\end{array}\right] = \left[\begin{array}{ccc}\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & \frac{-1}{\sqrt{6}}\\ 0 & \frac{1}{\sqrt{3}} & \frac{2}{\sqrt{6}} \\ \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \end{array}\right]\left[\begin{array}{cc}\sqrt{2} & \sqrt{2}  \\ 0 & \sqrt{3}\\0 & 0\end{array}\right]
        \end{align*}


\end{enumerate}
\end{solution}

\begin{problem}[Exercise 7.5]
    Let \( A \) be a \( m\times n \) matrix \( (m\geq n) \), and let \( A=\hat{Q}\hat{R} \) be a reduced QR factorization.
    \begin{enumerate}
        \item[(a)] Show that \( A \) has rank \( n \) if and only if all the diagonal entries of \( \hat{R} \) are nonzero.
        \item[(b)] Suppose \( \hat{R} \) has \( k \) nonzero diagonal entries for some \( k \) with \( 0\leq k\leq n \). What does this imply about the rank of \( A \)? Exactly \( k \)? At least \( k \)? At most \( k \)? Give a precise answer, and prove it.
    \end{enumerate}
\end{problem}

\begin{solution}[Solution]
We first prove the following: \textit{If \( F \) is full rank, and \( FA \) is well defined, then \( FA \) and \( A \) have the same rank.}

Indeed, let \( F \) be a full rank matrix, and let \( A \) be a matrix such that \( FA \) is well defined. By the rank-nullity theorem,  \( \ker(F)=\{0\} \) That is, \( Fu=0 \Leftrightarrow u=0 \). 

Then, 
\begin{align*}
    w\in\ker(A) \Leftrightarrow Aw=0 \Leftrightarrow FAw=0 \Leftrightarrow w\in\ker(FA)
\end{align*}
Thus \( \ker(A) = \ker(FA) \), so by the rank-nullity theorem, \( A \) and \( FA \) have the same rank.

With this is mind, let \( A \) be a \( m\times n \) matrix \( (m\geq n) \), and let \( A=\hat{Q}\hat{R} \) be a reduced QR factorization. Then \( \hat{Q} \) is full rank and \( \hat{R} \) is upper triangular.

\begin{enumerate}
    \item[(a)] By the above result, the fact that the determinant of a triangular matrix is the product of the diagonal, and by the invertible matrix theorem, the following are equivalent:
        \begin{itemize}[nolistsep]
           \item \( \hat{R} \) has no nonzero entries
           \item\( \hat{R} \) has nonzero determinant 
           \item \( \hat{R} \) has rank \( n \) 
           \item \( A \) has rank \( n \) 
        \end{itemize}
        This proves \( A \) has rank \( n \) if and only if all the diagonal entries of \( \hat{R} \) are nonzero. \qed    
    \item[(b)] Suppose \( \hat{R} \) has \( k \) nonzero diagonal entries. Consider the \( k \) columns corresponding to the nonzero diagonal entries labeled \( c_1, c_2, ..., c_k \). Observe \( c_j \) has a nonzero component with higher index than any \( c_i \) with \( i<j \). Therefore \( c_j \) is not in the span of \( c_1, ..., c_{j-1} \). By induction it is clear that \( c_1, ..., c_k \) are linearly independent.

        Then \( \hat{R} \) has at least \( k \) linearly independent columns. That is, the rank of \( \hat{R} \) is at least \( k \).

        Equality is not always attained. For instance, \( A=\left[\begin{array}{cc}0 & 1\\0 & 0\end{array}\right] \) is rank 1. However the QR factorization is \( A=IA \), which has no nonzero diagonal entires on \( \hat{R}=A \).

       Therefore, since \( \hat{Q} \) is full rank, the rank of \( A \) is at least \( k \). \qed
\end{enumerate}

\end{solution}

\begin{problem}[Exercise 8.1]
Let \( A \) be an \( m\times n \) matrix. Determine the exact number of floating point additions, subtractions, multiplications, and divisions involved in computing the factorization \( A=\hat{Q}\hat{R} \) by Algorithm 8.1.
\end{problem}

\begin{solution}[Solution]
Let \( A \) be an \( m\times n \) matrix. Algorithm 8.1 is displayed below, along with line numbering.

\begin{lstlisting}[mathescape=true, numbers=left, xleftmargin=2em,frame=single,framexleftmargin=1.5em]
for  $i=1$ to $n$
    $v_i =  a_i$
for $i=1$ to $n$
    $r_{ii}=\norm{v_i}$
    $q_i=v_i/r_{ii}$
    for $j=i+1$ to $n$
        $r_{ij}=q_i^*v_j$
        $v_j=v_j-r_{ij}q_i$
\end{lstlisting}

First observe \( a_i,v_i,q_i \) are all vectors in \( \CC^m \).

The first for loop simply reassigns \( v_i \) to \( a_i \). This does not require any floating point operations, however it does require memory allocation.

In line 4 we assign \( r_ii \) to \( \norm{v_i} \). Calculating the norm of \( v_i \) takes \( m \) products, \( m-1 \) sums, and then one square root.
Thus, this link takes \( m+(m-1)+1=2m \) flops.

In line 5 we assign \( q_i \) to \( v_i/r_{ii} \). We have calculated \( r_{ii} \) in the previous line, so this requires \( m \) divisions.

In line 7 we assign \( r_{ij} \) to \( q_i^*v_j \).This inner product takes \( m \) multiplications and \( m-1 \) additions.
Thus, this line takes \( m+(m-1)=2m-1 \) flops.

In line 8 we assign \( v_j=v_j- r_{ij}q_i \). We have already calculated \( r_{ij} \) and \( q_{i} \) so this takes \( m \) multiplications.We then have \( m \) subtractions.

For a fixed \( i \), lines 7 and 8 occur at each \( j=i+1, i+2, ..., n \).

Lines 4 through 8 occur for \( i=1,2, ..., n \).

The total number of flops is then give by,

\begin{align*}
    \text{\# of flops} &= \sum_{i=1}^{n}\left[ m+(m-1)+1+m+\sum_{j=i+1}^{n}[m+(m-1)+m+m] \right] \\
    &= \sum_{i=1}^{n}\left[3m+\sum_{j=i+1}^{n}[4m-1]\right] \\
    &=\left(3m\sum_{i=1}^{n}1\right)+\left((4m-1)\sum_{i=1}^{n}\sum_{j=i+1}^{n}1\right) \\
    &=3mn + (4m-1)(n(n-1)/2)
\end{align*}


Alternatively, highlighting the specific floating point operations,
\begin{align*}
    \text{\# of flops} &= (\text{\color{red}\# of addition} + \text{\color{blue}\# of subtraction} + \text{\color{green}\# of multiplication} + \text{\color{violet}\# of division})  \\
    &= \sum_{i=1}^{n}\left[ {\color{green}m}+{\color{red}(m-1)}+1+{\color{violet} m}+\sum_{j=i+1}^{n}[{\color{green}m}+{\color{red}(m-1)}+{\color{green} m}+{\color{blue}m}] \right] \\
    &= {\color{red} (m-1)n+(m-1)(n(n-1)/2)} + {\color{blue} mn(n-1)/2}+ {\color{green} mn+2m(n(n-1)/2)} + {\color{violet} mn} + n \\
    &= {\color{red} (m-1)(n(n+1)/2)} + {\color{blue}mn(n-1)/2}  +{\color{green} mn^2} + {\color{violet} mn} + n 
\end{align*}

\begin{align*}
    {\color{red} \text{\# of addition}} &= (m-1)(n(n+1))/2 \\ 
    {\color{blue} \text{\# of subtraction}} &= mn(n-1)/2 \\
    {\color{green} \text{\# of multiplication}}  &=mn^2 \\
    {\color{violet} \text{\# of division}} &= mn \\
    \text{\# of others} &= n
\end{align*}
    

\end{solution}


\end{document}
